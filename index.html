<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover, shrink-to-fit=no">
    <title>ğŸ“® è°ƒçš®è°œç›’ Â· åƒä¸‡åˆ«æ¾æ‰‹</title>
    <!-- å¾®ä¿¡æ‰‹æœºç«¯ç›´æ¥æ‰“å¼€ï¼Œçº¯è°ƒçš®ä¸‹é—¯å…³ï¼Œåªå­—ä¸æå·§å…‹åŠ›/ç¤¼ç‰©ï¼Œæœ€åæ‰çˆ†å‡ºé‚®æ”¿å•å·+å–ä»¶ç  -->
    <style>
        /* å…¨å±€æ‰‹æœºä¼˜åŒ– + è¶…æ·˜æ°”é£æ ¼ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            user-select: none;
            -webkit-user-select: none;
        }

        body {
            background: linear-gradient(145deg, #f1e2d3, #ecdccc);
            font-family: 'PingFang SC', 'Helvetica Neue', 'Segoe UI', 'Microsoft YaHei', sans-serif;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 12px;
            /* å¾®ä¿¡å®‰å…¨åŒº */
            padding: constant(safe-area-inset-top) constant(safe-area-inset-right) constant(safe-area-inset-bottom) constant(safe-area-inset-left);
            padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);
        }

        .naughty-box {
            max-width: 480px;
            width: 100%;
            background: rgba(255, 244, 230, 0.8);
            backdrop-filter: blur(18px);
            -webkit-backdrop-filter: blur(18px);
            border-radius: 64px 64px 48px 48px;
            padding: 26px 20px 38px;
            box-shadow: 0 30px 45px rgba(128, 88, 56, 0.25);
            border: 4px solid rgba(255, 215, 175, 0.9);
            position: relative;
            overflow: hidden;
        }

        /* å®Œå…¨ä¸æ˜ç¤ºç¤¼ç‰©ï¼Œä½†è£…é¥°ä¸€ç‚¹è°ƒçš®å°çœ¼ç› */
        .bg-eyes {
            position: absolute;
            top: 10px;
            right: 25px;
            font-size: 35px;
            opacity: 0.15;
            transform: rotate(15deg);
            z-index: 0;
        }

        .content-wrap {
            position: relative;
            z-index: 10;
        }

        /* æ·˜æ°”é‚®æ”¿å®˜ */
        .postmaster {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            background: #3e5d4f;
            padding: 12px 18px;
            border-radius: 60px;
            color: #ffeecc;
            border: 3px solid #dec27e;
            box-shadow: 0 8px 0 #22332b;
        }

        .postmaster-left {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 22px;
            font-weight: 700;
        }

        .postmaster-right {
            background: #ffe0a3;
            color: #2d3a35;
            padding: 8px 20px;
            border-radius: 50px;
            font-size: 18px;
            font-weight: 600;
            border: 2px dashed #5b7a6b;
        }

        /* è¿›åº¦æ¡åŒºåŸŸ Â· æ£è›‹é¬¼è¿›åº¦ */
        .progress-rogue {
            background: #efd3bf;
            padding: 14px 20px;
            border-radius: 50px;
            margin-bottom: 30px;
            border: 3px solid #cfaa8a;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 19px;
            font-weight: 700;
            color: #4b3621;
            box-shadow: inset 0 4px 10px rgba(0,0,0,0.03);
        }

        .stage-name {
            background: #bb9a7b;
            color: white;
            padding: 6px 24px;
            border-radius: 40px;
            letter-spacing: 3px;
        }

        /* ä¸»è°œæ±  â€”â€” äº’åŠ¨å°±åœ¨è¿™é‡Œä½¿å */
        .puzzle-pool {
            background: #fff9f0;
            border-radius: 48px;
            padding: 30px 16px;
            margin-bottom: 30px;
            box-shadow: 0 16px 0 #ad8b72, 0 20px 40px rgba(80, 50, 25, 0.25);
            border: 4px solid #ffe8cf;
            min-height: 280px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: box-shadow 0.1s;
            position: relative;
        }

        .trickster-emoji {
            font-size: 95px;
            line-height: 1;
            filter: drop-shadow(0 14px 6px rgba(70, 40, 10, 0.2));
            animation: wiggle 2.5s infinite;
        }

        @keyframes wiggle {
            0%, 100% { transform: rotate(-4deg) scale(1); }
            50% { transform: rotate(6deg) scale(1.08); }
        }

        .hint-area {
            font-size: 26px;
            background: #faead3;
            padding: 14px 28px;
            border-radius: 60px;
            font-weight: 700;
            color: #4f3322;
            margin: 18px 0 6px;
            border: 3px solid #fff2cf;
            box-shadow: 0 7px 0 #b18f75;
            text-align: center;
            max-width: 90%;
            word-break: break-word;
        }

        /* è¶…æ·˜æ°”ä¸»æŒ‰é’® â€”â€” ä¼šéª—äºº */
        .btn-naughty {
            background: #9d7b8c;
            border: none;
            color: white;
            font-size: 28px;
            font-weight: 800;
            padding: 18px 28px;
            border-radius: 100px;
            width: 100%;
            max-width: 300px;
            margin: 5px auto 0;
            box-shadow: 0 18px 0 #563b49, 0 10px 30px #b2897a;
            transition: all 0.12s;
            letter-spacing: 8px;
            border: 3px solid #ffdbb5;
            cursor: pointer;
            text-shadow: 2px 2px 0 #3e2e36;
        }

        .btn-naughty:active {
            transform: translateY(12px);
            box-shadow: 0 6px 0 #563b49, 0 10px 30px #b2897a;
        }

        .btn-naughty:disabled {
            opacity: 0.7;
            transform: translateY(8px);
            box-shadow: 0 8px 0 #563b49;
        }

        /* æœ€ç»ˆå½©è›‹ç›’å­ â€”â€” æš´é£å¼å±•å¼€ï¼ */
        .final-boom {
            margin-top: 30px;
            background: radial-gradient(circle at 10% 30%, #3d5a4b, #1f302a);
            border-radius: 40px;
            padding: 28px 24px;
            border: 6px solid #ffeaa5;
            box-shadow: 0 0 50px #ffd78a, inset 0 0 15px #141e1b;
            color: #fffbe3;
            transition: all 0.6s cubic-bezier(0.22, 1.52, 0.66, 1);
        }

        .post-single {
            font-size: 22px;
            background: #23332e;
            padding: 18px 22px;
            border-radius: 28px;
            border: 3px solid #e6c288;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 16px;
            color: #ffefc4;
            font-weight: 600;
            word-break: break-all;
        }

        .pickup-single {
            background: #1d2b26;
            padding: 22px;
            border-radius: 32px;
            border: 4px solid #ffe694;
            text-align: center;
        }

        .pickup-single div:first-child {
            font-size: 24px;
            color: #ffe2a4;
            margin-bottom: 8px;
        }

        .pickup-single div:last-child {
            font-size: 48px;
            font-weight: 900;
            letter-spacing: 10px;
            color: #fff6c9;
            text-shadow: 0 0 10px #ffb86b;
        }

        .shake-pool {
            animation: headshake 0.5s cubic-bezier(0.36, 0.07, 0.19, 0.97) both;
        }

        @keyframes headshake {
            0% { transform: translateX(0); }
            20% { transform: translateX(-9px); }
            40% { transform: translateX(9px); }
            60% { transform: translateX(-6px); }
            80% { transform: translateX(6px); }
            100% { transform: translateX(0); }
        }

        .footer-tease {
            margin-top: 30px;
            text-align: center;
            font-size: 16px;
            color: #8f7762;
            font-style: italic;
        }
    </style>
</head>
<body>
    <div class="naughty-box">
        <div class="bg-eyes">ğŸ‘€ ğŸ‘€ ğŸ‘€</div>
        <div class="content-wrap">
            <!-- é‚®æ”¿å°æ·˜æ°”ï¼Œå®Œå…¨ä¸æç¤¼ç‰© -->
            <div class="postmaster">
                <div class="postmaster-left">
                    <span style="font-size: 34px;">ğŸ“¯</span> é‚®æ”¿å°æ£è›‹
                </div>
                <div class="postmaster-right">
                    ä¸‰å° Â· è°œä¿¡
                </div>
            </div>

            <!-- è¿›åº¦æ¡ï¼Œæ¯å…³åå­—å¾ˆçš® -->
            <div class="progress-rogue" id="progressRogue">
                <span id="phaseName">ğŸ“® ç¬¬1å° Â· éª—ä½ æ˜¯æ˜Ÿæ˜Ÿ</span>
                <span id="phaseEmoji">ğŸ¤¥âœ¨</span>
            </div>

            <!-- æ ¸å¿ƒæ£ä¹±åŒºï¼Œæ¯å…³ç”»é£éƒ½çš®ä¸€ä¸‹ -->
            <div class="puzzle-pool" id="puzzlePool">
                <!-- JSåŠ¨æ€å¡«å……æ·˜æ°”å†…å®¹ -->
            </div>

            <!-- ä¸»æŒ‰é’® â€”â€” æ¯å…³åŠŸèƒ½ä¸åŒï¼Œè¿˜ä¼šéª—äºº -->
            <div style="display: flex; justify-content: center;">
                <button class="btn-naughty" id="mainNaughtyBtn">ğŸ¤¨ æŒ‰æˆ‘ï¼Ÿ</button>
            </div>

            <!-- ç»å¯¹ä¿å¯†çš„æœ€ç»ˆç‚¸å¼¹ï¼Œé€šå…³å‰å®Œå…¨éšè— -->
            <div id="finalTreasure" style="display: none;" class="final-boom">
                <div style="display: flex; gap: 10px; align-items: center; margin-bottom: 20px;">
                    <span style="font-size: 40px;">ğŸ“¬</span>
                    <span style="font-size: 26px; font-weight: 700;">ä¸­å›½é‚®æ”¿ Â· æœºå¯†ä¸“é€’</span>
                </div>
                <div class="post-single">
                    <span style="font-size: 32px;">ğŸ“®</span> è¿å•å·ï¼š9813896195387
                </div>
                <div class="pickup-single">
                    <div>ğŸ” å–ä»¶å¯†ä»¤</div>
                    <div>1-1-4007</div>
                </div>
                <div style="margin-top: 18px; font-size: 20px; text-align: right; color: #ffeec2;">â€”â€” è°ƒçš®é¬¼ä¹Ÿæœ‰çœŸå¿ƒ â€”â€”</div>
            </div>

            <div class="footer-tease">
                âš¡ åƒä¸‡åˆ«ä¿¡æŒ‰é’®ä¸Šçš„è¯ âš¡
            </div>
        </div>
    </div>

    <script>
        (function() {
            "use strict";

            // ---------- è°ƒçš®ä¸‰è¿å…³ï¼Œå®Œå…¨æ— å…³å·§å…‹åŠ›/ç¤¼ç‰©ï¼Œäº’åŠ¨çš®åˆ°ä¸è¡Œ ----------
            const TRICK_PHASE = {
                BOX1: 1,   // ç¬¬ä¸€å°ï¼šéª—ä½ æ˜¯æ˜Ÿæ˜Ÿ â€”â€” æŒ‰é’®éª—äººï¼Œè¦ç‚¹æ—è¾¹
                BOX2: 2,   // ç¬¬äºŒå°ï¼šé•¿æŒ‰ä½†ä¼šè·‘ â€”â€” æŒ‰é’®ä¼šå·å·ç§»åŠ¨ï¼Œå¿…é¡»æŠ“å®ƒ
                BOX3: 3,   // ç¬¬ä¸‰å°ï¼šæ‘‡æ™ƒæ”¶é›†3ä¸ªâ€œè¯šå®è±†â€ ï¼ˆä½†å…¶å®è¿˜æ˜¯çš®ï¼‰
                DONE: 4    // ç»ˆç« ï¼šç‚¸å‡ºå¿«é€’ä¿¡æ¯
            };

            let currentPhase = TRICK_PHASE.BOX1;

            // ----- ç¬¬ä¸€å…³ éª—å­æ˜Ÿæ˜Ÿ -----
            let starCount = 0;
            const STAR_MAX = 5;   // éœ€è¦æ”¶é›†5é¢—æ˜Ÿæ˜Ÿ
            // éª—å­æŒ‰é’®è®¡æ•°
            let fakeClickCount = 0;

            // ----- ç¬¬äºŒå…³ æŒ‰é’®ä¼šè·‘ï¼ é•¿æŒ‰ä½†æŒ‰é’®ä¼šèº² -----
            let catchProgress = 0;
            const CATCH_REQUIRED = 100;  // ç´¯ç§¯â€œæŠ“ä½â€è¿›åº¦100
            let isCaught = false;
            let runawayTimer = null;
            let holdActive = false;

            // ----- ç¬¬ä¸‰å…³ æ‘‡æ™ƒæ”¶é›†è¯šå®è±†ï¼ˆå…¶å®æ˜¯ä¸‰ä¸ªæ·˜æ°”è±†ï¼‰-----
            let collectedBeans = [];
            const BEAN_TYPES = ['ğŸ¤¥', 'ğŸ‘€', 'ğŸ’¨'];  // ä¸‰ä¸ªæ£è›‹é¬¼ç¬¦å·ï¼Œä¸å«å·§å…‹åŠ›
            const BEAN_REQUIRED = 3;

            // æœ€ç»ˆå¿«é€’ä¿¡æ¯
            const POST_NUMBER = "9813896195387";
            const PICKUP = "1-1-4007";

            // DOM
            const phaseNameEl = document.getElementById('phaseName');
            const phaseEmojiEl = document.getElementById('phaseEmoji');
            const puzzlePool = document.getElementById('puzzlePool');
            const mainBtn = document.getElementById('mainNaughtyBtn');
            const finalBox = document.getElementById('finalTreasure');

            // ---------- å…¨å±€æ¸²æŸ“æ´¾å‘ ----------
            function renderPhase() {
                switch (currentPhase) {
                    case TRICK_PHASE.BOX1: renderBox1(); break;
                    case TRICK_PHASE.BOX2: renderBox2(); break;
                    case TRICK_PHASE.BOX3: renderBox3(); break;
                    case TRICK_PHASE.DONE: renderDone(); break;
                }
            }

            // **** ç¬¬ä¸€å…³ Â· éª—ä½ æ˜¯æ˜Ÿæ˜Ÿ ****
            function renderBox1() {
                phaseNameEl.innerText = 'ğŸ“® ç¬¬1å° Â· éª—ä½ æ˜¯æ˜Ÿæ˜Ÿ';
                phaseEmojiEl.innerText = 'ğŸ¤¥âœ¨';
                mainBtn.innerText = 'ğŸŒŸ ç‚¹æˆ‘æ‹¿æ˜Ÿæ˜Ÿ';
                mainBtn.disabled = false;
                mainBtn.style.display = 'block';
                // é‡ç½®å…³å†…å˜é‡
                starCount = 0;
                fakeClickCount = 0;

                // è°ƒçš®æ–‡æ¡ˆï¼šæŒ‰é’®æ˜¯éª—å­ï¼å¿…é¡»ç‚¹å‡»æ—è¾¹çš„å°æ˜Ÿæ˜Ÿ
                puzzlePool.innerHTML = `
                    <div class="trickster-emoji">ğŸ¤¥ğŸ“®</div>
                    <div class="hint-area">éª—ä½ çš„ï¼æŒ‰æŒ‰é’®æ²¡æ˜Ÿæ˜Ÿ</div>
                    <div style="font-size: 55px; margin: 10px 0; display: flex; gap: 20px; justify-content: center;" id="starContainer">
                        <span style="cursor: pointer; transition: 0.1s;" class="star-item">âœ¨</span>
                        <span style="cursor: pointer; transition: 0.1s;" class="star-item">âœ¨</span>
                        <span style="cursor: pointer; transition: 0.1s;" class="star-item">âœ¨</span>
                        <span style="cursor: pointer; transition: 0.1s;" class="star-item">âœ¨</span>
                        <span style="cursor: pointer; transition: 0.1s;" class="star-item">âœ¨</span>
                    </div>
                    <div style="font-size: 22px; background: #f0cfb0; padding: 10px 24px; border-radius: 30px; margin-top: 12px;">
                        æ”¶é›†æ˜Ÿæ˜Ÿ: <span id="starCountDisplay">0</span>/5  â­
                    </div>
                    <div style="font-size: 17px; color: #b2452b; margin-top: 8px;">(åˆ«æŒ‰æŒ‰é’®ï¼ŒæŒ‰ä¸Šé¢çš„æ˜Ÿæ˜Ÿâœ¨æ‰ç»™ï¼)</div>
                `;

                // ç»™æ˜Ÿæ˜ŸåŠ ç›‘å¬
                setTimeout(() => {
                    const stars = document.querySelectorAll('.star-item');
                    stars.forEach(star => {
                        star.addEventListener('click', function starHandler(e) {
                            e.stopPropagation();
                            if (currentPhase !== TRICK_PHASE.BOX1) return;
                            // è°ƒçš®: æ˜Ÿæ˜Ÿä¼šè·‘æ‰å‡ ä¸ªï¼Ÿ ä½†å…¶å®ç›´æ¥åŠ 
                            starCount++;
                            document.getElementById('starCountDisplay')?.innerText = starCount;
                            // éœ‡åŠ¨ç›’å­
                            document.querySelector('.puzzle-pool')?.classList.add('shake-pool');
                            setTimeout(() => document.querySelector('.puzzle-pool')?.classList.remove('shake-pool'), 400);
                            
                            // æŠŠå®ƒå˜æš—è¡¨ç¤ºå·²æ”¶é›†
                            this.style.opacity = '0.4';
                            this.style.pointerEvents = 'none';
                            
                            if (starCount >= STAR_MAX) {
                                // é€šå…³ï¼å»ç¬¬äºŒå…³
                                currentPhase = TRICK_PHASE.BOX2;
                                renderPhase();
                            }
                        });
                    });
                }, 30);
            }

            // ç¬¬ä¸€å…³ä¸»æŒ‰é’®ç‚¹å‡» â€”â€” æ˜¯éª—å­ï¼ç‚¹å®ƒä¸ä¼šå¢åŠ æ˜Ÿæ˜Ÿï¼Œè¿˜ä¼šå˜²è®½
            function box1BtnAction() {
                fakeClickCount++;
                // è°ƒçš®åé¦ˆï¼šå‡è£…ç”Ÿæ°”ï¼Œæ™ƒåŠ¨
                puzzlePool.classList.add('shake-pool');
                setTimeout(() => puzzlePool.classList.remove('shake-pool'), 400);
                // å˜²è®½æ–‡æ¡ˆä¸´æ—¶æ›´æ¢
                const hint = document.querySelector('.hint-area');
                if (hint) {
                    if (fakeClickCount === 1) hint.innerText = 'ğŸ¤¥ å°±è¯´éª—ä½ çš„å’¯';
                    else if (fakeClickCount === 2) hint.innerText = 'ğŸ˜— ä¸ä¿¡ï¼Ÿå†æŒ‰ä¹Ÿæ˜¯éª—ä½ ';
                    else if (fakeClickCount >= 3) hint.innerText = 'ğŸ˜œ å¿«å»ç‚¹æ˜Ÿæ˜Ÿå•¦ï¼';
                }
            }

            // **** ç¬¬äºŒå…³ Â· é•¿æŒ‰ä½†ä¼šè·‘ï¼ˆæŒ‰é’®ä¼šèº²ï¼‰****
            function renderBox2() {
                phaseNameEl.innerText = 'ğŸ“® ç¬¬2å° Â· æŠ“ä¸ä½çš„æ·˜æ°”åŒ…';
                phaseEmojiEl.innerText = 'ğŸƒğŸ’¨';
                mainBtn.innerText = 'ğŸ˜œ æ¥æŠ“æˆ‘å‘€';
                mainBtn.disabled = false;
                mainBtn.style.display = 'block';
                catchProgress = 0;
                isCaught = false;
                holdActive = false;
                if (runawayTimer) clearInterval(runawayTimer);

                puzzlePool.innerHTML = `
                    <div class="trickster-emoji">ğŸ‘»ğŸ“®</div>
                    <div class="hint-area">é•¿æŒ‰æŒ‰é’® â€”â€” ä½†å®ƒä¼šè·‘ï¼</div>
                    <div style="background: #af988c; width: 80%; border-radius: 30px; margin: 20px 0 10px; padding: 5px;">
                        <div id="catchBar" style="background: #ffe6a1; width: 0%; border-radius: 30px; height: 28px; transition: width 0.08s;"></div>
                    </div>
                    <div style="font-size: 22px; font-weight: bold; color: #492e1c;" id="catchPercent">0% æŠ“ä½å•¦?</div>
                    <div style="font-size: 16px; margin-top: 14px; background: #ebcbb2; padding: 8px 20px; border-radius: 40px;">âš ï¸ æ‰‹æŒ‡åˆ«æ¾ï¼Œå®ƒä¼šé€ƒèµ°ï¼</div>
                `;
            }

            // ç¬¬äºŒå…³ï¼šè§¦æ‘¸å¼€å§‹ â€”â€” æŒ‰ä½æ—¶è¿›åº¦æ¶¨ï¼›åŒæ—¶æŒ‰é’®ä¼šéšæœºå¾€å³/å·¦åç§»ï¼ˆè°ƒçš®è·‘è·¯ï¼‰
            function onHoldStart2(e) {
                e.preventDefault();
                if (currentPhase !== TRICK_PHASE.BOX2) return;
                if (holdActive) return;
                holdActive = true;
                // æ¯æ¬¡é•¿æŒ‰ï¼Œè¿›åº¦ä»0å¼€å§‹ç´¯ç§¯
                catchProgress = 0;
                updateCatchUI(0);
                
                const interval = setInterval(() => {
                    if (!holdActive || currentPhase !== TRICK_PHASE.BOX2) {
                        clearInterval(interval);
                        return;
                    }
                    // è°ƒçš®ï¼šæŒ‰é’®ä¼šéšæœºæ¨ªå‘ç§»åŠ¨ï¼Œæ¨¡æ‹Ÿâ€œè·‘æ‰â€
                    const randomX = Math.floor(Math.random() * 30) - 15;  // -15px åˆ° 15px
                    const randomY = Math.floor(Math.random() * 10) - 5;
                    mainBtn.style.transform = `translate(${randomX}px, ${randomY}px)`;
                    
                    // è¿›åº¦å¢åŠ ï¼Œä½†å¾ˆæ…¢ï¼Œè¦è€å¿ƒ
                    catchProgress += 2.2;  // å¤§çº¦éœ€è¦45ä¸ªé—´éš”
                    if (catchProgress >= CATCH_REQUIRED) {
                        catchProgress = CATCH_REQUIRED;
                        updateCatchUI(100);
                        // é€šå…³ï¼è¿›å…¥ç¬¬ä¸‰å…³
                        clearInterval(interval);
                        currentPhase = TRICK_PHASE.BOX3;
                        holdActive = false;
                        mainBtn.style.transform = `translate(0px, 0px)`; // å¤ä½
                        renderPhase();
                    } else {
                        updateCatchUI(catchProgress);
                    }
                }, 50);
                runawayTimer = interval;
            }

            function updateCatchUI(progress) {
                const bar = document.getElementById('catchBar');
                const text = document.getElementById('catchPercent');
                if (bar) bar.style.width = Math.min(progress, 100) + '%';
                if (text) text.innerText = Math.floor(Math.min(progress, 100)) + '% æŠ“ä½å•¦?';
            }

            function onHoldEnd2(e) {
                if (currentPhase === TRICK_PHASE.BOX2) {
                    holdActive = false;
                    if (runawayTimer) clearInterval(runawayTimer);
                    runawayTimer = null;
                    // æ¾æ‰‹è¿›åº¦æ¸…é›¶ï¼Œä¸”æŒ‰é’®å¤ä½
                    catchProgress = 0;
                    updateCatchUI(0);
                    mainBtn.style.transform = `translate(0px, 0px)`;
                    // è°ƒçš®æ–‡æ¡ˆ
                    const hint = document.querySelector('.hint-area');
                    if (hint) hint.innerText = 'ğŸ˜† è·‘æ‰å•¦ï¼å†é•¿æŒ‰';
                }
            }

            // **** ç¬¬ä¸‰å…³ï¼šæ‘‡æ™ƒæ”¶é›†ä¸‰ä¸ªâ€œè¯šå®è±†â€ â€” ä½†è±†å­ä¼šåŠ¨ï¼****
            function renderBox3() {
                phaseNameEl.innerText = 'ğŸ“® ç¬¬3å° Â· è±†å­ä¹Ÿæ·˜æ°”';
                phaseEmojiEl.innerText = 'ğŸ¤¥ğŸ‘€ğŸ’¨';
                mainBtn.innerText = 'ğŸ¥´ æ‘‡ä¸€æ‘‡';
                mainBtn.disabled = true;   // æŒ‰é’®æ²¡ç”¨äº†ï¼Œç›´æ¥ç‚¹è±†å­
                mainBtn.style.opacity = '0.6';
                collectedBeans = [];

                puzzlePool.innerHTML = `
                    <div style="font-size: 45px; margin-bottom: 5px;">ğŸ§ğŸ”</div>
                    <div class="hint-area">æˆ³è¿™ä¸‰ä¸ªæ£è›‹è±†ï¼</div>
                    <div style="display: flex; justify-content: center; gap: 40px; margin: 25px 0 10px;">
                        <span style="font-size: 75px; cursor: pointer; transition: 0.2s;" class="bean-item" id="bean1">ğŸ¤¥</span>
                        <span style="font-size: 75px; cursor: pointer; transition: 0.2s;" class="bean-item" id="bean2">ğŸ‘€</span>
                        <span style="font-size: 75px; cursor: pointer; transition: 0.2s;" class="bean-item" id="bean3">ğŸ’¨</span>
                    </div>
                    <div style="font-size: 24px; margin-top: 12px; background: #eaceb8; padding: 10px 25px; border-radius: 50px;">
                        å·²æ•è· <span id="beanCount">0</span>/3 ä¸ªå°è°ƒçš®
                    </div>
                    <div style="font-size: 16px; color: #a1472b; margin-top: 12px;">ğŸ˜ˆ å®ƒä»¬ä¼šèº²ï¼Œç‚¹ä¸­éœ€è¦ç¼˜åˆ†ï¼</div>
                `;
                attachBeanListeners();
            }

            function attachBeanListeners() {
                setTimeout(() => {
                    const bean1 = document.getElementById('bean1');
                    const bean2 = document.getElementById('bean2');
                    const bean3 = document.getElementById('bean3');
                    if (bean1) bean1.addEventListener('click', (e) => beanClickHandler(e, 'ğŸ¤¥'));
                    if (bean2) bean2.addEventListener('click', (e) => beanClickHandler(e, 'ğŸ‘€'));
                    if (bean3) bean3.addEventListener('click', (e) => beanClickHandler(e, 'ğŸ’¨'));
                }, 30);
            }

            function beanClickHandler(e, type) {
                if (currentPhase !== TRICK_PHASE.BOX3) return;
                if (!collectedBeans.includes(type)) {
                    // è°ƒçš®ï¼šè±†å­ä¼šéšæœºç§»åŠ¨ä½ç½®ï¼
                    e.target.style.transform = `translate(${Math.random()*30-15}px, ${Math.random()*30-15}px)`;
                    e.target.style.opacity = '0.8';
                    // ä½†æœ‰50%å‡ ç‡çœŸæ­£æ”¶é›†ï¼ˆå¢åŠ éš¾åº¦ä¸è°ƒçš®ï¼‰
                    if (Math.random() > 0.3) {  // 70% æ”¶é›†ï¼Œ30% æˆå¼„ä½ 
                        collectedBeans.push(type);
                        e.target.style.opacity = '0.3';
                        e.target.style.pointerEvents = 'none';
                        document.getElementById('beanCount').innerText = collectedBeans.length;
                        // éœ‡åŠ¨
                        puzzlePool.classList.add('shake-pool');
                        setTimeout(() => puzzlePool.classList.remove('shake-pool'), 400);
                        
                        if (collectedBeans.length === BEAN_REQUIRED) {
                            currentPhase = TRICK_PHASE.DONE;
                            renderPhase();
                        }
                    } else {
                        // æ²¡æ”¶é›†åˆ°ï¼Œè¿˜è¦å˜²è®½
                        alert('ğŸ‘€ ç•¥ç•¥ç•¥ï¼Œæ²¡ç‚¹åˆ°ï¼å†æˆ³ï½');
                    }
                }
            }

            // **** æœ€ç»ˆï¼šç‚¸å‡ºä¸­å›½é‚®æ”¿ + å–ä»¶ç ï¼ ****
            function renderDone() {
                phaseNameEl.innerText = 'ğŸ’Œ ç»ˆå° Â· è°ƒçš®é¬¼çš„çœŸå¿ƒ';
                phaseEmojiEl.innerText = 'ğŸ“¬ğŸ’˜';
                mainBtn.style.display = 'none';  // æŒ‰é’®æ¶ˆå¤±
                puzzlePool.innerHTML = `
                    <div style="font-size: 80px;">ğŸ‰ğŸ“¬ğŸ‰</div>
                    <div style="font-size: 30px; font-weight: 700; background: #e1cbb2; padding: 16px 24px; border-radius: 60px; margin-top: 10px;">æ­å–œï¼è°ƒçš®é¬¼è®¤è¯</div>
                `;
                // äº®å‡ºæœ€ç»ˆå®è— â€”â€” å¿«é€’ä¿¡æ¯
                finalBox.style.display = 'block';
            }

            // ---------- äº‹ä»¶ç»‘å®š ----------
            function bindNaughtyEvents() {
                // ä¸»æŒ‰é’®ç‚¹å‡» â€”â€” æ ¹æ®ä¸åŒå…³ï¼Œåˆ†åˆ«å¤„ç†
                mainBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    if (currentPhase === TRICK_PHASE.BOX1) {
                        box1BtnAction();
                    } else if (currentPhase === TRICK_PHASE.BOX2) {
                        // ç‚¹æŒ‰æ²¡ç”¨ï¼Œæç¤ºé•¿æŒ‰
                        alert('ğŸƒ è¦é•¿æŒ‰ï¼ç‚¹ä¸€ä¸‹å®ƒå°±è·‘å•¦');
                    }
                });

                // ç¬¬äºŒå…³é•¿æŒ‰è§¦æ‘¸ç›‘å¬
                mainBtn.addEventListener('touchstart', onHoldStart2, { passive: false });
                mainBtn.addEventListener('touchend', onHoldEnd2);
                mainBtn.addEventListener('touchcancel', onHoldEnd2);

                // ç¦ç”¨é»˜è®¤å³é”®èœå•
                document.addEventListener('contextmenu', (e) => e.preventDefault());
            }

            // å¯åŠ¨
            function init() {
                finalBox.style.display = 'none';
                renderPhase();
                bindNaughtyEvents();
            }

            init();
        })();
    </script>
</body>
</html>